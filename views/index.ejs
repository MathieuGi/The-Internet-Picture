<!DOCTYPE html>
<html>
<head>
    <title>C'est qui le plus riche ?</title>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta/css/bootstrap.min.css" integrity="sha384-/Y6pD6FV/Vv2HJnA6t+vslU6fwYXjCFtcEpHbNJ0lyAFsXTsjBbfaDjzALeQsN6M" crossorigin="anonymous">
    <link rel='stylesheet' href='/stylesheets/main.css' />
</head>
<body>
<div class="container-fluid">

  <div class="paiement-success text-center">
    Transaction effectuée ! Merci pour votre confiance !
  </div>
  <div class="row main-title">
<!--    <div class="col-md-4 img1">
      <img class="float-right" src="images/static/header2.png">
    </div> -->
    <div class="col-md-12 text-center">
      <h1>Qui est le plus riche ?</h1>
    </div>
<!--    <div class="col-md-4 img2">
      <img class="float-left" src="images/static/header1.png">
    </div> -->
  </div>

  <!-- Menu area -->
  <div class="row" id="menu">

    <div class="col-md-4 menu-item text-center" id="rank-table-area">
      Classement
    </div>

    <div class="col-md-4 menu-item active text-center" id="picture-area">
      Image
    </div>

    <div class="col-md-4 menu-item text-center" id="bid-more">
      Enchérir
    </div>

  </div>

  <!--Rank part -->
  <div class="row main-area rank-table-area">
    <div class="col-md-8 mx-auto">

      <!-- Header part -->
      <div class="rank-header">
        <span>Classement</span>
        <img src="images/static/arrow-down.png" alt="down-arrow"/>
      </div>

      <!-- Rank table -->
      <div class="rank-table">
        <table class="table table-responsive table-striped">
          <tbody>
            <% bidders.forEach(function(bidder, index){ %>
            <tr>
              <td class="align-middle"><img class="thumbs" src="images/thumbs/<%= bidder.img_path %>" alt="image miniature"></td>
              <td class="align-middle text-truncate"><%= bidder.name %></td>
              <td class="align-middle"><%= bidder.price %> €</td>
              <td class="align-middle">
              <%if (bidder.bid_time == 0) { %>
                -
              <% } else { %>
                <% var date = new Date(bidder.bid_time) %>
                <% var day = Math.trunc(bidder.bid_time/24/3600/1000) %>
                <% var hours = date.getHours()-1 %>
                <% var seconds = date.getSeconds() %>
                <%= day > 0 ? day : '' %>
                <%= day = 1 && day > 0 ? ' jour' : '' %>
                <%= day > 1 && day > 0 ? ' jour' : '' %>
                <%= day== 0 && hours == 0 ? '' : hours %>
                <%= hours > 1 && hours > 0 ? ' heures' : '' %>
                <%= hours == 1 && hours > 0 ? ' heure' : '' %>
                <%= bidder.bid_time >= 60000 ? date.getMinutes() : '' %>
                <%= date.getMinutes() > 1 && bidder.bid_time >= 60000 ? ' minutes' : '' %>
                <%= date.getMinutes() == 1 && bidder.bid_time >= 60000 ? ' minute' : '' %>
                <%= day == 0 && hours == 0 ? seconds : '' %>
                <%= seconds > 1 && seconds > 0 ? ' secondes' : '' %>
                <%= seconds == 1 && seconds > 0 ? ' seconde' : '' %>
              <% } %>
              </td>
            </tr>
            <% }) %>

            <% if(bidders.length === 10) { %>
            <tr id="load-more">
              <td class="align-middle text-center" colspan="4">
                <button class="btn btn-primary btn-block see-more" data-offset="10">Voir plus</button>
                <img class="loading" src="images/static/loading.gif"/>
              </td>
            </tr>
            <% } %>
          </tbody>
        </table>
      </div>
    </div>
  </div>

  <!-- home page -->
  <div class="row main-area picture-area justify-content-md-center align-items-end">

    <% include homepage %>

  </div>

  <!--Bid part-->
  <div class="row main-area bid-more">
    <div class="col-md-12 text-center">

      <!-- Paiement form -->
      <form id="paiement-form" novalidate>
        <div class="row">
          <div class="col-md-3"></div>

          <!-- Form first part -->
          <div class="col-md-6 information">

            <!-- Name -->
            <div class="form-group">
                <label for="form-name">Nom *</label>
                <input type="text" class="form-control" id="form-name" aria-describedby="name" placeholder="Entrez votre nom" required>
                <span class="error-message" id="mandatoryFields">Merci de renseigner un nom</span>
            </div>

            <!-- Image -->
            <div class="form-group">
                <label for="form-image">Image (jpeg, png, jpg, gif - Maximum 2Mo) *</label>
                <input type="file" class="form-control" id="form-image" accept=".jpeg, .jpg, .png, .gif" required>
                <span id="wrongImageType" class="error-message"> Seuls les type jpeg, jpg, png et gif sont acceptés </span>
                <span id="noImage" class="error-message"> Merci de selectionner une image </span>
                <span id="imageToBig" class="error-message"> La taille de l'image est trop importante </span>
            </div>
         
            <!-- Link -->
            <div class="form-group">
                <label for="form-url">Lien url</label>
                <input type="url" class="form-control" id="form-url" placeholder="Entrez un lien">
            </div>

            <!-- Text -->
            <div class="form-group">
                <label for="form-text">Texte complémentaire (160 caractères)</label>
                <input type="text" class="form-control" id="form-text" maxlength="160" placeholder="Entrez un text complémentaire">
            </div>

            <!-- Selected price -->
            <div class="form-group">
                <label for="form-price">Montant (€) *</label> - Meilleur enchère actuelle : <%= bidders[0].price %>
                <input type="number" class="form-control" id="form-price" value="<%= bidders[0].price + 1 %>" required> 
                <span class="error-message" id="missing-price">Merci de renseigner un prix</span>
            </div>

            <!-- Go to the pay part -->
              <a href="#paiement">
                <input type="button" id="trump" value="Renchérir" href="#paiement" />
              </a>
            
          </div>
        </div></br>
         
          <!-- Separation between the two parts of form -->
        <div class="row">
          <div class="col-md-3"></div>

          <!-- Form second part -->
          <div class="col-md-6 paiement" id="paiement">

            <!-- Card number -->
            <div class="form-group">
              <label for="card-element">Card</label>
              <div id="card-element" class="form-control"></div>
            </div>

            <!-- User terms -->
            <div class="checkbox">
              <label>
                  <input type="checkbox" checked> J'accepte les <a href="#" class="terms">conditions générales d'utilisation</a>
              </label>
            </div>

            <!-- Missing fields message -->
            <div class="invalid-feedback">
              Certains champs ne sont pas remplis correctement
            </div>

            <!-- Submit -->
            <div>
              <button class="confirm-button" id="buy-button">Valider</button>
              <img class="loading" src="images/static/loading.gif"/>
            </div>
            
            <p class="star-legend">* Champ obligatoire</p>

            <!-- Outcome for stripe -->
            <div class="outcome">
              <div class="error" role="alert"></div>
              <div class="success">
                <span class="token"></span>
              </div>
            </div>

          </div>
        </div>
      </form>
    </div>
  </div>
</div>
    
<script src="/jquery/jquery.js"></script>
<script src="/bootstrap/js/bootstrap.min.js"></script>
<script type="text/javascript" src="/javascripts/main.js" ></script> 
<script src="/socket.io/socket.io.js"></script>  
<script src="https://js.stripe.com/v3/"></script>
</body>
</html>